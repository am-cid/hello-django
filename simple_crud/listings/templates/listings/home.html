{% extends "listings/base.html" %}
{% load highlight %}
{% load static %} 

{% block content %}
<!-- search -->
<form method="GET" action="{% url 'home' %}">
  <label class="input input-bordered flex items-center gap-2">
    <input type="text" name="q" value="{{ query }}" class="grow" placeholder="Search listings..." />
    <svg
      xmlns="http://www.w3.org/2000/svg"
      viewBox="0 0 16 16"
      fill="currentColor"
      class="h-4 w-4 opacity-70">
      <path
        fill-rule="evenodd"
        d="M9.965 11.026a5 5 0 1 1 1.06-1.06l2.755 2.754a.75.75 0 1 1-1.06 1.06l-2.755-2.754ZM10.5 7a3.5 3.5 0 1 1-7 0 3.5 3.5 0 0 1 7 0Z"
        clip-rule="evenodd" />
    </svg>
    <button type="submit">Search</button>

  </label>
</form>

{% if listings %}
<ul>
  {% for listing in listings %}
  <li>
    <strong>
      <a href="{% url 'listing_detail' listing.pk %}">{{ listing.name|highlight:query  }}</a>
    </strong>
    - ${{ listing.price }} by 
    <a href="{% url 'profile' listing.seller.username %}">{{ listing.seller.username }}</a>
    <br />
    {{ listing.description|highlight:query }}
    <br />
    {% if user.is_authenticated and user == listing.seller %}
      <a href="{% url 'listing_update' listing.pk %}">Edit</a> |
      <a href="{% url 'listing_delete' listing.pk %}">Delete</a>
    {% endif %}
  </li>
  <br />
  {% endfor %}
</ul>
{% else %}
<p>No listings found</p>
{% endif %}

{% if user.is_authenticated %}
    <a href="{% url 'listing_create' %}">Create New Listing</a>
{% endif %}
{% endblock %}
